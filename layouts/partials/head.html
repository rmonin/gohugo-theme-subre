{{$title:= .Site.Title -}}
{{with .Site.Params.Subtitle}}{{$title = print $title " " .}}{{end -}}
{{if not .IsHome}}{{$title = print $title " | " .Title}}{{end -}}
{{$description:= .Description -}}
{{if not $description -}}
    {{if .IsPage}}{{$description = .Summary -}}
    {{else}}{{with .Site.Params.description}}{{$description = .}}{{end -}}
    {{end -}}
{{end -}}
{{$keywords:= .Site.Params.keywords -}}
{{with union .Site.Params.keywords .Params.keywords}}{{$keywords = delimit . ", "}}{{end -}}
{{$author:= .Site.Author.name -}}
{{with .Site.Author.email}}{{$author = print $author " (" . ")"}}{{end -}}

{{/* Asset bundles */ -}}
{{$assets:= newScratch -}}
{{$cssScheme:= resources.Get (printf "css/schemes/%s.css" (lower .Site.Params.colorScheme)) -}}
{{if not $cssScheme}}{{$cssScheme = resources.Get "css/schemes/subre.css"}}{{end -}}
{{if $cssScheme}}{{$assets.Add "css" (slice $cssScheme) -}}{{end -}}
{{$cssMain:= resources.Get "css/compiled/main.css" -}}
{{$assets.Add "css" (slice $cssMain) -}}
{{$cssCustom:= resources.Get "css/custom.css" -}}
{{if $cssCustom}}{{$assets.Add "css" (slice $cssCustom)}}{{end -}}
{{$bundleCSS:= $assets.Get "css" | resources.Concat "css/main.bundle.css" | resources.Minify | resources.Fingerprint "sha512" -}}

<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{$title}}</title>
    {{- with $description}}
    <meta name="description" content="{{.}}">{{end}}
    {{- with $keywords}}
    <meta name="keywords" content="{{.}}">{{end}}
    {{- with $author}}
    <meta name="author" content="{{.}}">{{end}}
    {{hugo.Generator}}
    <link rel="canonical" href="{{.Permalink}}">
    {{- if not hugo.IsProduction}}
    <meta name="robots" content="noindex, nofollow">{{end}}
    <meta name="format-detection" content="telephone=no">
    {{- with .Site.Params.themeColor}}
    <meta name="theme-color" content="{{.}}">{{end}}
    {{- with .Site.Params.themeColorLight}}
    <meta name="theme-color" media="(prefers-color-scheme: light)" content="{{.}}">{{end}}
    {{- with .Site.Params.themeColorDark}}
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="{{.}}">{{end}}
    <link
        type="text/css"
        rel="stylesheet"
        href="{{$bundleCSS.RelPermalink}}"
        integrity="{{$bundleCSS.Data.Integrity}}">
    <link
        type="text/css"
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
        integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer">
</head>